\documentclass{report}

\usepackage[a4paper,left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[nottoc]{tocbibind}
\usepackage[siunitx]{circuitikz}
\usepackage{subcaption}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{bbm}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{float}
\usepackage{stmaryrd}
%\usepackage{unicode-math}
\usepackage{physics}
\usepackage{titlesec}
\usepackage{lmodern}
\usepackage[toc,page]{appendix}
\setcounter{secnumdepth}{4}
\usepackage[T1]{fontenc}

\setlength{\parindent}{1em}
\setlength{\parskip}{1em}
\usepackage[font=footnotesize]{caption}
\usepackage[font=footnotesize]{subcaption}
\DeclareUnicodeCharacter{2212}{-}

\title{thesis of me}
\author{some terrible student}
\date{November 2020}

\begin{document}

\maketitle

\null\vfill

\begin{center}
	\parbox{\linewidth}{%
		\raggedright{\itshape%
			Und so bald eben diese ausdehnende Gewalt der Luft nachl\"aßt, so kehrt diejenige, die in allen H\"ohlen ausgebreitet  war, mit großer Gewalt zur\"uck und facht das erloschene Feuer zu einem neuen Erdbeben an.\par\bigskip
		}   
		\raggedleft\MakeUppercase{Immanuel Kant, 1756\cite{Kant}}\par%
	}
\end{center}


\vfill\vfill

\tableofcontents

\include{Introduction}

\include{FirstExperiments}

\include{TwoDimensionalSEASProblem}

\include{FourFormulationsForSEAS}

\include{Results}

\include{Extensions}

\begin{appendices}
	
	\chapter{Butcher tableaus of the used Runge-Kutta schemes}
	\label{apx:ButcherTableaus}
	
	\section{2nd order Bogacki-Shampine method}
	It is a 2nd order scheme with a 3rd order embedded method for the error estimate developped in 1989 \cite{RK-BogackiShampine}. It is well-suited if a rough error estimation is sufficient. The Butcher tableau reads:
	\begin{center}
		\begin{tabular}{c | c c c c}
			0 & & & & \\
			1/2 & 1/2 & & & \\
			3/4 & 0 & 3/4 & & \\
			1 & 2/9 & 1/3 & 4/9 & \\ \hline
			& 2/9 & 1/3 & 4/9 & 0 \\
			& 7/24 & 1/4 & 2/3 & 1/8
		\end{tabular}
	\end{center}
	
	\section{4th order Fehlberg method}
	It is a 4th order scheme with a 5th order embedded method for the error estimate developped in 1969 \cite{RK-Fehlberg}. It gives a more accurate error estimate than the RK-BS scheme and converges with 4th order. The Butcher tableau reads:
	
	\begin{center}
		\begin{tabular}{c | c c c c c c}
			0 & & & & & & \\
			1/4 & 1/4 & & & & & \\
			3/8 & 3/32 & 9/32 & & & &\\
			12/13 & 1932/2197 &	−7200/2197 & 7296/2197 & & & \\
			1 & 439/216 & −8 & 3680/513 & −845/4104 & & \\
			1/2 & −8/27 & 2 & −3544/2565 & 1859/4104 & −11/40 	& \\ \hline
			& 16/135 & 0 & 6656/12825 & 28561/56430 & −9/50 & 2/55 \\ 
			& 25/216 & 0 & 1408/2565 & 2197/4104 & −1/5 & 0 
		\end{tabular}
	\end{center}
	
	
	\section{5th order Dormand-Prince method}
	It is a 5th order scheme with a 4th order embedded method for the error estimate developped in 1969 \cite{RK-DormandPrince}. Unlike the Fehlberg scheme, it minimizes the error of the 5th order solution. The Butcher tableau reads:
	
	\begin{center}
	\begin{tabular}{c | c c c c c c c}
	0 & & & & & & & \\
	1/5 & 1/5 & & & & & & \\
	3/10 & 3/40 & 9/40 & & & & & \\
	4/5 & 44/45 & −56/15 & 32/9 & & & & \\
	8/9 & 19372/6561 & −25360/2187 & 64448/6561 & −212/729 & & & \\
	1 & 9017/3168 & −355/33 & 46732/5247 & 49/176 & −5103/18656 & & \\
	1 & 35/384 & 0 & 500/1113 & 125/192 & −2187/6784 & 11/84 & \\ \hline	
	& 35/384 & 0 & 500/1113 & 125/192 & −2187/6784 & 11/84 & 0 \\
	& 5179/57600 & 0 & 7571/16695 & 393/640 & −92097/339200 & 187/2100 & 1/40 
	\end{tabular}
	\end{center}

	
	\chapter{Alternative derivation of the BDF method}
	\label{apx:BDF_derivation_Taylor}
	The first order BDF-scheme corresponds to the backward Euler method in \autoref{eq:BDF_coeffs_1st_order}.
	\begin{equation}
	\label{eq:BDF_coeffs_1st_order}
	\psi_{n+1} = \psi_n + h_{n}f(\psi_{n+1},V_{n+1})
	\end{equation}
	Next, we try to derive the second order BDF-scheme. Because of the adaptive time-stepping, the traditional coefficients of the BDF2 scheme cannot be used, but will be dependent of the current and previous timestep sizes $h_{n+1}$ and $h_n$. To find these coefficients, the Taylor polynomials of $\psi_n$ and $\psi_{n+1}$ are evaluated with respect to the unknown $\psi_{n+2}$. 
	\begin{align}
	\label{eq:taylor-polynomialBDF1(1)}
	\psi_{n} &= \psi_{n+2} - (h_{n} + h_{n+1})\frac{d\psi_{n+2}}{dt} + \frac{(h_{n} + h_{n+1})^2}{2}\frac{d^2\psi_{n+2}}{dt^2} + \mathcal{O}\left((h_{n} + h_{n+1})^3\right) \\
	\label{eq:taylor-polynomialBDF1(2)}
	\psi_{n+1} &= \psi_{n+2} - h_{n+1}\frac{d\psi_{n+2}}{dt} + \frac{h_{n+1}^2}{2}\frac{d^2\psi_{n+2}}{dt^2} + \mathcal{O}\left(h_{n+1}^3\right)
	\end{align}
	The idea is to add equations (\ref{eq:taylor-polynomialBDF1(1)}) and (\ref{eq:taylor-polynomialBDF1(2)}), where the latter is multiplied by a factor $\alpha$ in a way that the second-derivative term drops. The addition of the two Taylor-expansions yields: 
	\begin{equation}
	\psi_{n} + \alpha \psi_{n+1} = (1+\alpha)\psi_{n+2} - \left(h_{n} + (1+\alpha)h_{n+1}\right)\frac{d\psi_{n+2}}{dt} + \frac{(h_{n} + h_{n+1})^2+\alpha h_{n+1}^2}{2}\frac{d^2\psi_{n+2}}{dt^2} + \mathcal{O}\left(h^3\right) \\
	\end{equation}
	By the choice of $\alpha$ in \autoref{eq:alpha}, the coefficient in front of the second time derivative of $\psi_{n+2}$ vanishes and the second order time adaptive BDF method is given by: \autoref{eq:BDF_coeffs_2nd_order}. 
	\begin{align}
	\label{eq:alpha}
	\alpha &= -\left(\frac{h_n}{h_{n+1}}\right)^2 - 2\frac{h_n}{h_{n+1}} - 1 \\
	\label{eq:BDF_coeffs_2nd_order}
	\psi_n + \alpha \psi_{n+1} -(1+\alpha)\psi_{n+2} &= -\left(h_n + (1+\alpha)h_{n+1}\right)f(\psi_{n+2}, V_{n+2})
	\end{align}
	Analogously, the time-adapative third-order BDF3 scheme is given with the coefficients: 
	\begin{align}
	\alpha &= -\frac{\left(h_n+h_{n+1}\right)\left(h_n+h_{n+1}+h_{n+2}\right)^2}
	{h_{n+1}\left(h_{n+1}+h_{n+2}\right)^2} \\
	\beta &= \frac{h_n\left(h_n+h_{n+1}+h_{n+2}\right)^2}
	{h_{n}^2h_{n+1}}
	\end{align}
	\begin{equation}
	\label{eq:BDF_coeffs_3rd_order}
	\psi_n + \alpha \psi_{n+1} + \beta \psi_{n+2} -(1+\alpha+\beta)\psi_{n+3} = \left(h_n + (1+\alpha)h_{n+1} + (1+\alpha+\beta)h_{n+2}\right)f(\psi_{n+3},V_{n+3})
	\end{equation}
	
	\chapter{Reduced Jacobian system for the extended DAE formulation}
	\label{apx:ReducedJacobianExtendedDAE}
	To efficiently apply iterative solvers for the extended DAE formulation, a blockwise Gaussian-elimination on the sparse components of the Jacobian matrix can be calculated such that the iterative solvers are only applied on a dense subsystem. For a general 2D problem, the Jacobian system takes the form: 
	\begin{equation}
		\begin{pmatrix}
			\mathbf{J}_{11} & \mathbf{0}      & \mathbf{J}_{13} \\
			\mathbf{0}        & \mathbf{J}_{22} & \mathbf{J}_{23}   \\
			\mathbf{B}      & \mathbf{J}_{32} & \mathbf{J}_{33}   \\
		\end{pmatrix}\begin{pmatrix}
		   				x_1 \\ x_2 \\ x_3 
					 \end{pmatrix} = \begin{pmatrix}
										 b_1 \\ b_2 \\ b_3 
									 \end{pmatrix}
 	\end{equation}
 	The sparse components are in the submatrices $\mathbf{J}_{ij}$ and the dense parts are in $\mathbf{B}$. After the Gaussian elimination, we get:
	\begin{align}
	\begin{pmatrix}
		\mathbf{B} - \mathbf{J}_{33}\mathbf{J}_{13}^{-1}\mathbf{J}_{11} + \mathbf{J}_{32}\mathbf{J}_{22}^{-1}\mathbf{J}_{23}\mathbf{J}_{13}^{-1}\mathbf{J}_{11} & \mathbf{0} & \mathbf{0} \\
		-\mathbf{J}_{23}\mathbf{J}_{13}^{-1}\mathbf{J}_{11} & \mathbf{J}_{22} & \mathbf{0}   \\
		\mathbf{J}_{11} & \mathbf{0} & \mathbf{J}_{13} \\
	\end{pmatrix}\begin{pmatrix}
					x_1 \\ x_2 \\ x_3 
			     \end{pmatrix} =  \qquad\qquad\qquad\qquad\nonumber \\ \qquad\qquad\qquad\qquad\qquad\qquad\qquad
	\begin{pmatrix}
		b_3 - \mathbf{J}_{33}\mathbf{J}_{13}^{-1}b_1 - \mathbf{J}_{32}\mathbf{J}_{22}^{-1}\left(b_2 - \mathbf{J}_{23}\mathbf{J}_{13}^{-1}b_1\right) 
		\\ b_2 - \mathbf{J}_{23}\mathbf{J}_{13}^{-1}b_1 
		\\ b_1 
   	 \end{pmatrix}
	\end{align}
 The upper-left block form the reduced system which is solved iteratively. The other solution components are then calculated by an easy backward substitution.

\end{appendices}

\bibliographystyle{alpha}
\bibliography{literature.bib}

\end{document}
